{"version":3,"sources":["../../../src/react/traits/debug.js"],"names":["React","displayName","printer","withDebugUpdates","print","_","monkeyPatch","ref","originalFunction","shouldComponentUpdate","nextProps","nextState","nextContext","propsDiff","stateDiff","key","props","push","state","debug","toString","join","bind","render","Component"],"mappings":";;;;;;;;AAEA;;AAEA,OAAOA,KAAP,MAAkB,OAAlB;;AAGA,SAASC,WAAT,QAA4B,WAA5B;;AAEA,SAASC,OAAT,QAAwB,qBAAxB;;AAEA,OAAO,IAAMC,mBAA6B,SAA7BA,gBAA6B;AAAA,0BAAGC,KAAH;AAAA,QAAGA,KAAH,8BAAW,UAACC,CAAD;AAAA,eAAuBA,CAAvB;AAAA,KAAX;AAAA,WAA0C;AAAA;;AAAA;AAAA;;AAAA;AAAA;;AAAA;;AAAA;;AAAA;AAAA;AAAA;;AAAA,oMAG5EC,WAH4E,GAG9D,UAACC,GAAD,EAAiB;AAC3B,wBAAG,CAACA,GAAJ,EAAS;AACT,wBAAMC,mBAAmBD,IAAIE,qBAA7B;AACAF,wBAAIE,qBAAJ,GAA4B,UAASC,SAAT,EAAoBC,SAApB,EAA+BC,WAA/B,EAA4C;AACpE,4BAAMC,YAAY,EAAlB;AACA,4BAAMC,YAAY,EAAlB;AACA,6BAAI,IAAMC,GAAV,IAAiBL,SAAjB,EAA4B;AACxB,gCAAGA,UAAUK,GAAV,MAAmBR,IAAIS,KAAJ,CAAUD,GAAV,CAAtB,EACIF,UAAUI,IAAV,CAAeF,GAAf;AACP;AACD,6BAAI,IAAMA,KAAV,IAAiBJ,SAAjB,EAA4B;AACxB,gCAAGA,UAAUI,KAAV,MAAmBR,IAAIW,KAAJ,CAAUH,KAAV,CAAtB,EACID,UAAUG,IAAV,CAAeF,KAAf;AACP;AACD;AACAb,gCAAQiB,KAAR,6BAAwCf,MAAMG,IAAIa,QAAJ,EAAN,CAAxC,0BAAkFN,UAAUO,IAAV,CAAe,GAAf,CAAlF,uBAAuHR,UAAUQ,IAAV,CAAe,GAAf;AACvH;AADA,0BAEA,OAAOb,iBAAiBc,IAAjB,CAAsBf,GAAtB,EAA2BG,SAA3B,EAAsCC,SAAtC,CAAP;AACH,qBAfD;AAgBH,iBAtB2E,QAwB5EY,MAxB4E,GAwBnE;AAAA,2BACL,oBAAC,SAAD,eAAe,MAAKP,KAApB;AACI,6BAAM;AAAA,mCAAO,MAAKV,WAAL,CAAiBC,KAAjB,CAAP;AAAA,yBADV,IADK;AAAA,iBAxBmE;AAAA;;AAAA;AAAA,UAClEP,MAAMwB,SAD4D,UAErEvB,WAFqE,GAEvDA,YAAY,kBAAZ,EAAgCuB,SAAhC,CAFuD;AAAA,KAA1C;AAAA,CAAnC","file":"debug.js","sourcesContent":["// @flow\n\n/* Add debug info for component updates */\n\nimport React from \"react\"\n\nimport type { trait } from \"./helpers\"\nimport { displayName } from \"./helpers\"\n\nimport { printer } from \"../../tools/printer\"\n\nexport const withDebugUpdates : trait<> = ({ print = (_:string) : string => _ }) => Component =>\n    class extends React.Component {\n        static displayName = displayName(\"withDebugUpdates\", Component)\n        monkeyPatch = (ref: Object) => {\n            if(!ref) return\n            const originalFunction = ref.shouldComponentUpdate\n            ref.shouldComponentUpdate = function(nextProps, nextState, nextContext) {\n                const propsDiff = []\n                const stateDiff = []\n                for(const key in nextProps) {\n                    if(nextProps[key] !== ref.props[key])\n                        propsDiff.push(key)\n                }\n                for(const key in nextState) {\n                    if(nextState[key] !== ref.state[key])\n                        stateDiff.push(key)\n                }\n                /* eslint-disable */\n                printer.debug(`shouldComponentUpdate [${print(ref.toString())}]`, `State diff : ${stateDiff.join(\" \")}\\nProps diff : ${propsDiff.join(\" \")}`)\n                /* eslint-enable */\n                return originalFunction.bind(ref)(nextProps, nextState)\n            }\n        }\n\n        render = () =>\n            <Component {...this.props}\n                ref={ ref => this.monkeyPatch(ref) }>\n            </Component>\n\n    }\n"]}