{"version":3,"sources":["../../../src/vue/components/TreeView.js"],"names":["object","tree","RootNode","defaults","TreeViewNode","withLabels","mixListener","TreeViewBase","name","mixins","eventType","cb","autoMount","created","rootNode","get","$props","filter","prop","onSelect","onDrag","dragndrop","drag","onDrop","drop","onCancel","cancel","$data","set","key","s","$forceUpdate","modifierCb","onKey","props","data","searchInput","filtered","methods","onSearch","evt","input","currentTarget","value","trim","model","category","treeFilter","search","computed","computedModel","sort","wrapDragNDrop","render","rest","filteredModel","ancestors","folded","searched","searchBar","labels","mixCss","TreeView"],"mappings":"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","file":"TreeView.js","sourcesContent":["import { object, tree } from \"../../tools\"\nimport { RootNode, defaults } from \"../../core\"\nimport { TreeViewNode } from \"./TreeViewNode\"\nimport { withLabels } from \"../traits\"\nimport { mixListener } from \"../mixins\"\n\nconst TreeViewBase = {\n    name: \"TreeView\",\n    mixins: [\n        mixListener({ eventType: \"keydown\", cb: \"modifierCb\", autoMount: true }),\n        mixListener({ eventType: \"keyup\",   cb: \"modifierCb\", autoMount: true })\n    ],\n    created() {\n        this.rootNode = new RootNode(\n            {\n                get: () => ({\n                    ...defaults,\n                    ...object(this.$props).filter(prop => !!prop)\n                })\n            },\n            {\n                onSelect:   this.$props.onSelect,\n                onDrag:     this.$props.dragndrop && this.$props.dragndrop.drag,\n                onDrop:     this.$props.dragndrop && this.$props.dragndrop.drop,\n                onCancel:   this.$props.dragndrop && this.$props.dragndrop.cancel\n            },\n            {\n                get: () => ({ ...this.$data }),\n                set: s => {\n                    for(const key in s) {\n                        if(key in this.$data) this.$data[key] = s[key]\n                    }\n                }\n            },\n            this.$forceUpdate\n        )\n        this.modifierCb = this.rootNode.onKey\n    },\n    props: [ \"model\", \"category\", \"selection\", \"onSelect\", \"display\", \"search\", \"transition\",\n        \"strategies\", \"labels\", \"css\", \"dragndrop\", \"sort\", \"disabled\", \"noOpener\", \"async\" ],\n    data: () => ({\n        searchInput: \"\",\n        filtered: null\n    }),\n    methods: {\n        onSearch(evt) {\n            const input = evt.currentTarget.value\n            this.$data.searchInput = input\n            this.$data.filtered = !input.trim() ? null :\n                tree(this.$props.model, this.$props.category)\n                    .treeFilter(this.$props.search(input.trim()))\n        }\n    },\n    computed: {\n        computedModel() {\n            return this.$props.sort ?\n                this.$props.model.sort(this.$props.sort) :\n                this.$props.model\n        },\n        wrapDragNDrop() { return this.rootNode.wrapDragNDrop() }\n    },\n    render() {\n        const { onSelect, sort, model, ...rest } = object(this.$props).filter(prop => !!prop)\n        const data = {\n            props: {\n                ...defaults,\n                ...rest,\n                model: this.computedModel,\n                filteredModel: this.$data.filtered,\n                onSelect: this.rootNode.onSelect,\n                dragndrop: this.wrapDragNDrop,\n                ancestors: [],\n                sort: sort,\n                folded: false,\n                searched: !!this.$data.searchInput.trim()\n            }\n        }\n\n        const searchBar = !this.$props.search ? null :\n            <input\n                type=\"search\"\n                class={ this.rootNode.mixCss(\"search\") }\n                value={ this.$data.searchInput }\n                placeholder={ this.$props.labels && this.$props.labels[\"search.placeholder\"] }\n                onInput={ this.onSearch } />\n\n        return (\n            <div class={ this.rootNode.mixCss(\"TreeView\") }>\n                { searchBar }\n                <TreeViewNode { ...data } />\n            </div>\n        )\n    }\n}\n\nexport const TreeView = withLabels(defaults.labels)(TreeViewBase)\n"]}